{"data":{"Article":{"html":"<h3>IAM User Setup</h3>\n<p>The first thing you'll need to do is create an IAM user that will have\npermissions to run queries with Amazon Athena and access the S3 buckets that\ncontain your data.</p>\n<h3>Create IAM Policy to Allow Access to Your S3 Bucket</h3>\n<ol>\n<li>Sign in to the IAM console at <a href=\"https://console.aws.amazon.com/iam/\">https://console.aws.amazon.com/iam/</a>. </li>\n<li>In the navigation pane, choose Policies, and then Create Policy.</li>\n</ol>\n<p>In the policy body, you can use a policy similar to:</p>\n<pre><code>{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [{\n        \"Effect\": \"Allow\",\n        \"Action\": [\"s3:GetObject\"],\n        \"Resource\": [\"arn:aws:s3:::my-bucket/*\"]\n    }, {\n        \"Effect\": \"Allow\",\n        \"Action\": [\"s3:GetBucketLocation\", \"s3:ListBucket\"],\n        \"Resource\": [\"arn:aws:s3:::my-bucket\"]\n    }]\n}\n</code></pre>\n<p>Don't forget to change my-bucket to your bucket name. You can list several\nbuckets, but please note that we have separate permissions for the bucket (\n<code>arn:aws:s3:::my-bucket</code>) and the objects (<code>arn:aws:s3:::my-bucket/*</code>).</p>\n<h3>Create IAM User</h3>\n<ul>\n<li>Sign in to the IAM console at <a href=\"https://console.aws.amazon.com/iam/\">https://console.aws.amazon.com/iam/</a>.</li>\n<li>In the navigation pane, choose Users, and then Add User.</li>\n<li>Enter the desired User Name.</li>\n<li>Check the checkbox next to Programmatic Access and then click Next.</li>\n</ul>\n<p><img src=\"/assets/images/docs/gitbook/athena_iam_console1.png\"></p>\n<ul>\n<li>In the Permissions step, select Attach existing policies directly and attach the AWSQuicksightAthenaAccess policy along with the one to access S3 buckets you created previously.</li>\n</ul>\n<p><img src=\"/assets/images/docs/gitbook/athena_iam_console2.png\"></p>\n<ul>\n<li>Click Next, then review all the details and Create User.</li>\n<li>Take note of the Access Key ID and Secret Access Key.</li>\n</ul>\n<h2>Create Athena Data Source</h2>\n<p>In Redash, in the New Data Source page select \"Athena\" as the data source type\nand fill out the details using the information from the previous step:</p>\n<ul>\n<li>AWS Access Key and AWS Secret Key are the ones from the previous step.</li>\n<li>AWS Region is the region where you use Amazon Athena.</li>\n<li>S3 Staging Path is the bucket Amazon Athena uses for staging/query results, you might have created it already if you used Amazon Athena from AWS console - simply copy the same path.</li>\n</ul>\n<p><img src=\"/assets/images/docs/gitbook/athena_data_source.png\"></p>\n<h2>Run a Query</h2>\n<p>Woohoo, you did it! Now that everything's set up, you can query your data with\nAmazon Athena :)</p>\n<h2>Troubleshooting</h2>\n<p>If you're getting an error message saying: <strong>\"Insufficient permissions to execute the query.\"</strong>, then make sure that you gave permissions to the IAM user to access the S3 bucket where the data is stored.</p>","frontmatter":{"permalink":null,"title":"Amazon Athena Setup","description":null,"keywords":null,"parent_category":"data-sources","category":"setup","toc":null,"layout":null,"hide_topics":null},"parent":{"__typename":"File","relativePath":"kb/data-sources/amazon-athena-setup.md"}},"Parent":{"frontmatter":{"title":"Setup"}},"Section":{"name":"Data Sources"}},"pageContext":{"category":"setup","parent_category":"data-sources","slug":"amazon-athena"}}